<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Chapter 5 Lecture 5 - Data visualization for web-based maps | Introduction to Quantitative Research Methods for Public Administrators</title>
  <meta name="description" content="Course content for lab portion of PADM604">
  <meta name="generator" content="bookdown  and GitBook 2.6.7">

  <meta property="og:title" content="Chapter 5 Lecture 5 - Data visualization for web-based maps | Introduction to Quantitative Research Methods for Public Administrators" />
  <meta property="og:type" content="book" />
  <meta property="og:url" content="https://github.com/toschw/PADM604" />
  
  <meta property="og:description" content="Course content for lab portion of PADM604" />
  <meta name="github-repo" content="toschw/PADM604" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 5 Lecture 5 - Data visualization for web-based maps | Introduction to Quantitative Research Methods for Public Administrators" />
  
  <meta name="twitter:description" content="Course content for lab portion of PADM604" />
  

<meta name="author" content="Tobias Schwoerer">


<meta name="date" content="2019-03-04">

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="lecture-4-data-cleaning-and-manipulation.html">

<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />







<script src="libs/htmlwidgets-1.3/htmlwidgets.js"></script>
<link href="libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet" />
<script src="libs/datatables-binding-0.5/datatables.js"></script>
<link href="libs/dt-core-1.10.16/css/jquery.dataTables.min.css" rel="stylesheet" />
<link href="libs/dt-core-1.10.16/css/jquery.dataTables.extra.css" rel="stylesheet" />
<script src="libs/dt-core-1.10.16/js/jquery.dataTables.min.js"></script>
<link href="libs/crosstalk-1.0.0/css/crosstalk.css" rel="stylesheet" />
<script src="libs/crosstalk-1.0.0/js/crosstalk.min.js"></script>


<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Intro to Quantitative Research Methods</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a></li>
<li class="chapter" data-level="1" data-path="introduction-to-r-and-rmarkdown.html"><a href="introduction-to-r-and-rmarkdown.html"><i class="fa fa-check"></i><b>1</b> Introduction to R and RMarkdown</a><ul>
<li class="chapter" data-level="1.1" data-path="introduction-to-r-and-rmarkdown.html"><a href="introduction-to-r-and-rmarkdown.html#learning-objectives"><i class="fa fa-check"></i><b>1.1</b> Learning Objectives</a></li>
<li class="chapter" data-level="1.2" data-path="introduction-to-r-and-rmarkdown.html"><a href="introduction-to-r-and-rmarkdown.html#introduction-and-motivation"><i class="fa fa-check"></i><b>1.2</b> Introduction and Motivation</a><ul>
<li class="chapter" data-level="1.2.1" data-path="introduction-to-r-and-rmarkdown.html"><a href="introduction-to-r-and-rmarkdown.html#resources"><i class="fa fa-check"></i><b>1.2.1</b> Resources</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="introduction-to-r-and-rmarkdown.html"><a href="introduction-to-r-and-rmarkdown.html#r-at-the-console"><i class="fa fa-check"></i><b>1.3</b> R at the console</a><ul>
<li class="chapter" data-level="1.3.1" data-path="introduction-to-r-and-rmarkdown.html"><a href="introduction-to-r-and-rmarkdown.html#error-messages-are-your-friends"><i class="fa fa-check"></i><b>1.3.1</b> Error messages are your friends</a></li>
<li class="chapter" data-level="1.3.2" data-path="introduction-to-r-and-rmarkdown.html"><a href="introduction-to-r-and-rmarkdown.html#logical-operators-and-expressions"><i class="fa fa-check"></i><b>1.3.2</b> Logical operators and expressions</a></li>
<li class="chapter" data-level="1.3.3" data-path="introduction-to-r-and-rmarkdown.html"><a href="introduction-to-r-and-rmarkdown.html#clearing-the-environment"><i class="fa fa-check"></i><b>1.3.3</b> Clearing the environment</a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="introduction-to-r-and-rmarkdown.html"><a href="introduction-to-r-and-rmarkdown.html#rmarkdown"><i class="fa fa-check"></i><b>1.4</b> RMarkdown</a><ul>
<li class="chapter" data-level="1.4.1" data-path="introduction-to-r-and-rmarkdown.html"><a href="introduction-to-r-and-rmarkdown.html#your-turn"><i class="fa fa-check"></i><b>1.4.1</b> Your Turn</a></li>
<li class="chapter" data-level="1.4.2" data-path="introduction-to-r-and-rmarkdown.html"><a href="introduction-to-r-and-rmarkdown.html#code-chunks"><i class="fa fa-check"></i><b>1.4.2</b> Code chunks</a></li>
<li class="chapter" data-level="1.4.3" data-path="introduction-to-r-and-rmarkdown.html"><a href="introduction-to-r-and-rmarkdown.html#your-turn-1"><i class="fa fa-check"></i><b>1.4.3</b> Your turn</a></li>
</ul></li>
<li class="chapter" data-level="1.5" data-path="introduction-to-r-and-rmarkdown.html"><a href="introduction-to-r-and-rmarkdown.html#r-functions-help-pages"><i class="fa fa-check"></i><b>1.5</b> R functions, help pages</a><ul>
<li class="chapter" data-level="1.5.1" data-path="introduction-to-r-and-rmarkdown.html"><a href="introduction-to-r-and-rmarkdown.html#download-a-file-from-the-arctic-data-center"><i class="fa fa-check"></i><b>1.5.1</b> Download a file from the Arctic Data Center</a></li>
<li class="chapter" data-level="1.5.2" data-path="introduction-to-r-and-rmarkdown.html"><a href="introduction-to-r-and-rmarkdown.html#use-a-function-to-read-a-file-into-r"><i class="fa fa-check"></i><b>1.5.2</b> Use a function to read a file into R</a></li>
<li class="chapter" data-level="1.5.3" data-path="introduction-to-r-and-rmarkdown.html"><a href="introduction-to-r-and-rmarkdown.html#your-turn-2"><i class="fa fa-check"></i><b>1.5.3</b> Your turn</a></li>
</ul></li>
<li class="chapter" data-level="1.6" data-path="introduction-to-r-and-rmarkdown.html"><a href="introduction-to-r-and-rmarkdown.html#using-data.frames"><i class="fa fa-check"></i><b>1.6</b> Using <code>data.frames</code></a><ul>
<li class="chapter" data-level="1.6.1" data-path="introduction-to-r-and-rmarkdown.html"><a href="introduction-to-r-and-rmarkdown.html#your-turn-3"><i class="fa fa-check"></i><b>1.6.1</b> Your Turn</a></li>
</ul></li>
<li class="chapter" data-level="1.7" data-path="introduction-to-r-and-rmarkdown.html"><a href="introduction-to-r-and-rmarkdown.html#troubleshooting"><i class="fa fa-check"></i><b>1.7</b> Troubleshooting</a><ul>
<li class="chapter" data-level="1.7.1" data-path="introduction-to-r-and-rmarkdown.html"><a href="introduction-to-r-and-rmarkdown.html#i-just-entered-a-command-and-nothing-is-happening"><i class="fa fa-check"></i><b>1.7.1</b> I just entered a command and nothing is happening</a></li>
<li class="chapter" data-level="1.7.2" data-path="introduction-to-r-and-rmarkdown.html"><a href="introduction-to-r-and-rmarkdown.html#r-says-my-object-is-not-found"><i class="fa fa-check"></i><b>1.7.2</b> R says my object is not found</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="lecture-2.html"><a href="lecture-2.html"><i class="fa fa-check"></i><b>2</b> Lecture 2</a><ul>
<li class="chapter" data-level="2.1" data-path="lecture-2.html"><a href="lecture-2.html#rmarkdown-1"><i class="fa fa-check"></i><b>2.1</b> RMarkdown</a><ul>
<li class="chapter" data-level="2.1.1" data-path="lecture-2.html"><a href="lecture-2.html#your-turn-4"><i class="fa fa-check"></i><b>2.1.1</b> Your Turn</a></li>
<li class="chapter" data-level="2.1.2" data-path="lecture-2.html"><a href="lecture-2.html#code-chunks-1"><i class="fa fa-check"></i><b>2.1.2</b> Code chunks</a></li>
<li class="chapter" data-level="2.1.3" data-path="lecture-2.html"><a href="lecture-2.html#your-turn-5"><i class="fa fa-check"></i><b>2.1.3</b> Your turn</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="lecture-2.html"><a href="lecture-2.html#r-functions-help-pages-1"><i class="fa fa-check"></i><b>2.2</b> R functions, help pages</a><ul>
<li class="chapter" data-level="2.2.1" data-path="lecture-2.html"><a href="lecture-2.html#download-a-sample-frame-for-pilots"><i class="fa fa-check"></i><b>2.2.1</b> Download a sample frame for pilots</a></li>
<li class="chapter" data-level="2.2.2" data-path="lecture-2.html"><a href="lecture-2.html#use-a-function-to-read-a-file-into-r-1"><i class="fa fa-check"></i><b>2.2.2</b> Use a function to read a file into R</a></li>
<li class="chapter" data-level="2.2.3" data-path="lecture-2.html"><a href="lecture-2.html#using-data.frames-1"><i class="fa fa-check"></i><b>2.2.3</b> Using <code>data.frames</code></a></li>
<li class="chapter" data-level="2.2.4" data-path="lecture-2.html"><a href="lecture-2.html#subsetting-data-to-get-the-appropriate-sample-frame"><i class="fa fa-check"></i><b>2.2.4</b> Subsetting data to get the appropriate sample frame</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="lecture-3-data-modeling-tidy-data.html"><a href="lecture-3-data-modeling-tidy-data.html"><i class="fa fa-check"></i><b>3</b> Lecture 3 - Data Modeling &amp; Tidy Data</a><ul>
<li class="chapter" data-level="3.1" data-path="lecture-3-data-modeling-tidy-data.html"><a href="lecture-3-data-modeling-tidy-data.html#learning-objectives-1"><i class="fa fa-check"></i><b>3.1</b> Learning Objectives</a></li>
<li class="chapter" data-level="3.2" data-path="lecture-3-data-modeling-tidy-data.html"><a href="lecture-3-data-modeling-tidy-data.html#benefits-of-relational-data-systems"><i class="fa fa-check"></i><b>3.2</b> Benefits of relational data systems</a></li>
<li class="chapter" data-level="3.3" data-path="lecture-3-data-modeling-tidy-data.html"><a href="lecture-3-data-modeling-tidy-data.html#data-organization"><i class="fa fa-check"></i><b>3.3</b> Data Organization</a></li>
<li class="chapter" data-level="3.4" data-path="lecture-3-data-modeling-tidy-data.html"><a href="lecture-3-data-modeling-tidy-data.html#multiple-tables"><i class="fa fa-check"></i><b>3.4</b> Multiple tables</a></li>
<li class="chapter" data-level="3.5" data-path="lecture-3-data-modeling-tidy-data.html"><a href="lecture-3-data-modeling-tidy-data.html#inconsistent-observations"><i class="fa fa-check"></i><b>3.5</b> Inconsistent observations</a></li>
<li class="chapter" data-level="3.6" data-path="lecture-3-data-modeling-tidy-data.html"><a href="lecture-3-data-modeling-tidy-data.html#inconsistent-variables"><i class="fa fa-check"></i><b>3.6</b> Inconsistent variables</a></li>
<li class="chapter" data-level="3.7" data-path="lecture-3-data-modeling-tidy-data.html"><a href="lecture-3-data-modeling-tidy-data.html#marginal-sums-and-statistics"><i class="fa fa-check"></i><b>3.7</b> Marginal sums and statistics</a></li>
<li class="chapter" data-level="3.8" data-path="lecture-3-data-modeling-tidy-data.html"><a href="lecture-3-data-modeling-tidy-data.html#good-enough-data-modeling"><i class="fa fa-check"></i><b>3.8</b> Good enough data modeling</a><ul>
<li class="chapter" data-level="3.8.1" data-path="lecture-3-data-modeling-tidy-data.html"><a href="lecture-3-data-modeling-tidy-data.html#denormalized-data"><i class="fa fa-check"></i><b>3.8.1</b> Denormalized data</a></li>
<li class="chapter" data-level="3.8.2" data-path="lecture-3-data-modeling-tidy-data.html"><a href="lecture-3-data-modeling-tidy-data.html#tabular-data"><i class="fa fa-check"></i><b>3.8.2</b> Tabular data</a></li>
</ul></li>
<li class="chapter" data-level="3.9" data-path="lecture-3-data-modeling-tidy-data.html"><a href="lecture-3-data-modeling-tidy-data.html#primary-and-foreign-keys"><i class="fa fa-check"></i><b>3.9</b> Primary and Foreign Keys</a></li>
<li class="chapter" data-level="3.10" data-path="lecture-3-data-modeling-tidy-data.html"><a href="lecture-3-data-modeling-tidy-data.html#entity-relationship-model-er"><i class="fa fa-check"></i><b>3.10</b> Entity-Relationship Model (ER)</a></li>
<li class="chapter" data-level="3.11" data-path="lecture-3-data-modeling-tidy-data.html"><a href="lecture-3-data-modeling-tidy-data.html#merging-data"><i class="fa fa-check"></i><b>3.11</b> Merging data</a></li>
<li class="chapter" data-level="3.12" data-path="lecture-3-data-modeling-tidy-data.html"><a href="lecture-3-data-modeling-tidy-data.html#simple-guidelines-for-effective-data"><i class="fa fa-check"></i><b>3.12</b> Simple Guidelines for Effective Data</a></li>
<li class="chapter" data-level="3.13" data-path="lecture-3-data-modeling-tidy-data.html"><a href="lecture-3-data-modeling-tidy-data.html#data-modeling-assignment"><i class="fa fa-check"></i><b>3.13</b> Data modeling assignment</a></li>
<li class="chapter" data-level="3.14" data-path="lecture-3-data-modeling-tidy-data.html"><a href="lecture-3-data-modeling-tidy-data.html#related-resources"><i class="fa fa-check"></i><b>3.14</b> Related resources</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="lecture-4-data-cleaning-and-manipulation.html"><a href="lecture-4-data-cleaning-and-manipulation.html"><i class="fa fa-check"></i><b>4</b> Lecture 4 - Data Cleaning and Manipulation</a><ul>
<li class="chapter" data-level="4.1" data-path="lecture-4-data-cleaning-and-manipulation.html"><a href="lecture-4-data-cleaning-and-manipulation.html#learning-objectives-2"><i class="fa fa-check"></i><b>4.1</b> Learning Objectives</a></li>
<li class="chapter" data-level="4.2" data-path="lecture-4-data-cleaning-and-manipulation.html"><a href="lecture-4-data-cleaning-and-manipulation.html#introduction"><i class="fa fa-check"></i><b>4.2</b> Introduction</a></li>
<li class="chapter" data-level="4.3" data-path="lecture-4-data-cleaning-and-manipulation.html"><a href="lecture-4-data-cleaning-and-manipulation.html#setup"><i class="fa fa-check"></i><b>4.3</b> Setup</a></li>
<li class="chapter" data-level="4.4" data-path="lecture-4-data-cleaning-and-manipulation.html"><a href="lecture-4-data-cleaning-and-manipulation.html#about-the-pipe-operator"><i class="fa fa-check"></i><b>4.4</b> About the pipe (<code>%&gt;%</code>) operator</a></li>
<li class="chapter" data-level="4.5" data-path="lecture-4-data-cleaning-and-manipulation.html"><a href="lecture-4-data-cleaning-and-manipulation.html#selectingremoving-columns-select"><i class="fa fa-check"></i><b>4.5</b> Selecting/removing columns: <code>select()</code></a></li>
<li class="chapter" data-level="4.6" data-path="lecture-4-data-cleaning-and-manipulation.html"><a href="lecture-4-data-cleaning-and-manipulation.html#changing-shape-gather-and-spread"><i class="fa fa-check"></i><b>4.6</b> Changing shape: <code>gather()</code> and <code>spread()</code></a></li>
<li class="chapter" data-level="4.7" data-path="lecture-4-data-cleaning-and-manipulation.html"><a href="lecture-4-data-cleaning-and-manipulation.html#renaming-columns-with-rename"><i class="fa fa-check"></i><b>4.7</b> Renaming columns with <code>rename()</code></a></li>
<li class="chapter" data-level="4.8" data-path="lecture-4-data-cleaning-and-manipulation.html"><a href="lecture-4-data-cleaning-and-manipulation.html#adding-columns-mutate"><i class="fa fa-check"></i><b>4.8</b> Adding columns: <code>mutate()</code></a></li>
<li class="chapter" data-level="4.9" data-path="lecture-4-data-cleaning-and-manipulation.html"><a href="lecture-4-data-cleaning-and-manipulation.html#group_by-and-summarise"><i class="fa fa-check"></i><b>4.9</b> <code>group_by</code> and <code>summarise</code></a></li>
<li class="chapter" data-level="4.10" data-path="lecture-4-data-cleaning-and-manipulation.html"><a href="lecture-4-data-cleaning-and-manipulation.html#filtering-rows-filter"><i class="fa fa-check"></i><b>4.10</b> Filtering rows: <code>filter()</code></a></li>
<li class="chapter" data-level="4.11" data-path="lecture-4-data-cleaning-and-manipulation.html"><a href="lecture-4-data-cleaning-and-manipulation.html#sorting-your-data-arrange"><i class="fa fa-check"></i><b>4.11</b> Sorting your data: <code>arrange()</code></a></li>
<li class="chapter" data-level="4.12" data-path="lecture-4-data-cleaning-and-manipulation.html"><a href="lecture-4-data-cleaning-and-manipulation.html#joins-in-dplyr"><i class="fa fa-check"></i><b>4.12</b> Joins in dplyr</a></li>
<li class="chapter" data-level="4.13" data-path="lecture-4-data-cleaning-and-manipulation.html"><a href="lecture-4-data-cleaning-and-manipulation.html#separate-and-unite"><i class="fa fa-check"></i><b>4.13</b> <code>separate()</code> and <code>unite()</code></a></li>
<li class="chapter" data-level="4.14" data-path="lecture-4-data-cleaning-and-manipulation.html"><a href="lecture-4-data-cleaning-and-manipulation.html#summary"><i class="fa fa-check"></i><b>4.14</b> Summary</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="lecture-5-data-visualization-for-web-based-maps.html"><a href="lecture-5-data-visualization-for-web-based-maps.html"><i class="fa fa-check"></i><b>5</b> Lecture 5 - Data visualization for web-based maps</a><ul>
<li class="chapter" data-level="5.1" data-path="lecture-5-data-visualization-for-web-based-maps.html"><a href="lecture-5-data-visualization-for-web-based-maps.html#learning-objectives-3"><i class="fa fa-check"></i><b>5.1</b> Learning Objectives</a></li>
<li class="chapter" data-level="5.2" data-path="lecture-5-data-visualization-for-web-based-maps.html"><a href="lecture-5-data-visualization-for-web-based-maps.html#example"><i class="fa fa-check"></i><b>5.2</b> Example</a><ul>
<li class="chapter" data-level="5.2.1" data-path="lecture-5-data-visualization-for-web-based-maps.html"><a href="lecture-5-data-visualization-for-web-based-maps.html#load-salmon-escapement-data"><i class="fa fa-check"></i><b>5.2.1</b> Load salmon escapement data</a></li>
<li class="chapter" data-level="5.2.2" data-path="lecture-5-data-visualization-for-web-based-maps.html"><a href="lecture-5-data-visualization-for-web-based-maps.html#plot-median-escapement"><i class="fa fa-check"></i><b>5.2.2</b> Plot median escapement</a></li>
</ul></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Introduction to Quantitative Research Methods for Public Administrators</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="lecture-5---data-visualization-for-web-based-maps" class="section level1">
<h1><span class="header-section-number">Chapter 5</span> Lecture 5 - Data visualization for web-based maps</h1>
<div id="learning-objectives-3" class="section level2">
<h2><span class="header-section-number">5.1</span> Learning Objectives</h2>
<p>In this lesson, you will learn:</p>
<ul>
<li>A quick overview of producing nice visualizations in R with <code>ggplot</code></li>
<li>How to create interactive maps with <code>leaflet</code></li>
</ul>
</div>
<div id="example" class="section level2">
<h2><span class="header-section-number">5.2</span> Example</h2>
<p>First, let’s start a brand new RMarkdown document name it, and save it somewhere you can remember such a project folder.</p>
<p>Then, get some data. We’ll use salmon escapement data from the Alaska Department of Fish and Game.</p>
<ul>
<li>Navigate to <a href="https://knb.ecoinformatics.org/#view/urn:uuid:c14d3e59-e5e3-4696-996d-558446b577fd">Escapement Counts</a> and copy the Download URL for the <code>ADFG_firstAttempt_reformatted.csv</code> file</li>
<li>Download that file into R using <code>read.csv</code> to make the script portable</li>
<li>Calculate median annual escapement by species using the <code>dplyr</code> package</li>
<li>Make a bar plot of the median annual escapement by species using the <code>ggplot2</code> package</li>
<li>Display it in an interactive table with the <code>datatable</code> function from the <code>DT</code> package</li>
<li>And lastly, let’s make an interactive, map of the escapement sampling locations.</li>
</ul>
<p>To do this, we’ll use the <a href="https://rstudio.github.io/leaflet/"><code>leaflet</code></a> package to create an interactive map with markers for all the sampling locations:</p>
<p>First, let’s load the packages we’ll need:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">suppressPackageStartupMessages</span>({
  <span class="kw">library</span>(leaflet)
  <span class="kw">library</span>(dplyr)
  <span class="kw">library</span>(tidyr)
  <span class="kw">library</span>(ggplot2)
  <span class="kw">library</span>(DT)
})</code></pre></div>
<div id="load-salmon-escapement-data" class="section level3">
<h3><span class="header-section-number">5.2.1</span> Load salmon escapement data</h3>
<p>You can load the data table directly from the KNB Data Repository, if it isn’t already present on your local computer. This technique</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">esc &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;https://knb.ecoinformatics.org/knb/d1/mn/v2/object/knb.92020.1&quot;</span>, <span class="dt">stringsAsFactors =</span> <span class="ot">FALSE</span>)</code></pre></div>
</div>
<div id="plot-median-escapement" class="section level3">
<h3><span class="header-section-number">5.2.2</span> Plot median escapement</h3>
<p>Now that we have the data loaded, let’s calculate median annual escapement by species:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">median_esc &lt;-<span class="st"> </span>esc <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">separate</span>(sampleDate, <span class="kw">c</span>(<span class="st">&quot;Year&quot;</span>, <span class="st">&quot;Month&quot;</span>, <span class="st">&quot;Day&quot;</span>), <span class="dt">sep =</span> <span class="st">&quot;-&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">group_by</span>(Species, SASAP.Region, Year, Location) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">summarize</span>(<span class="dt">escapement =</span> <span class="kw">sum</span>(DailyCount)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">group_by</span>(Species) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">summarize</span>(<span class="dt">median_escapement =</span> <span class="kw">median</span>(escapement))

<span class="kw">head</span>(median_esc)</code></pre></div>
<p>That command used a lot of the dplyr commands that we’ve used, and some that are new. The <code>separate</code> function is used to divide the sampleDate column up into Year, Month, and Day columns, and then we use <code>group_by</code> to indicate that we want to calculate our results for the unique combinations of species, region, year, and location. We next use <code>summarize</code> to calculate an escapement value for each of these groups, which we then proceed to further group by species to caluclate the median for each species.</p>
<p>Now, let’s plot our results:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(median_esc, <span class="kw">aes</span>(Species, median_escapement)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_col</span>() <span class="op">+</span>
<span class="st">  </span><span class="kw">coord_flip</span>()</code></pre></div>
<p>Now let’s convert the escapement data into a table of just the unique locations:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">locations &lt;-<span class="st"> </span>esc <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">distinct</span>(Location, Latitude, Longitude) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">drop_na</span>()</code></pre></div>
<p>Then making a leaflet map is (generally) only a couple of lines of code:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">leaflet</span>(locations) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">addTiles</span>() <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">addMarkers</span>(<span class="op">~</span><span class="st"> </span>Longitude, <span class="op">~</span><span class="st"> </span>Latitude, <span class="dt">popup =</span> <span class="op">~</span><span class="st"> </span>Location)</code></pre></div>
<p>The <code>addTiles()</code> function gets a base layer of tiles from <a href="https://www.openstreetmap.org/">OpenStreetMap</a> which is an open alternative to Google Maps. <code>addMarkers</code> use a bit of an odd syntax but make sure you type the <code>~</code> for your map to work.</p>
<p>This map hopefully gives you an idea of how powerful RMarkdown can be. …and it makes a problem with these data much more obvious than in tabular form. Do you see all those points way over in Russia? This is an Alaska data set. Those data points aren’t supposed to be located in Russia. Can you guess why they’re showing up over there? If you glance through the coordinates in the <code>locations</code> table above it should become obvious. You could also simply look at the descriptive statistics for the data such as:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">summary</span>(esc)</code></pre></div>
<p>The Longtitude column has a negative minumum and a positive maximum. Since Alaska is West of the Greenwich Meridian (the 0 degree line of longtitude) all values in the Longtitude column must be negative. If we would have only Russian locations, all Longtitude values would be positive because they are East (right) of the Greenwich Meridian.</p>
<p>Here’s how to fix it:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">locs &lt;-<span class="st"> </span>locations <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="dt">Longitude =</span> <span class="kw">abs</span>(Longitude) <span class="op">*</span><span class="st"> </span><span class="op">-</span><span class="dv">1</span>)

<span class="kw">leaflet</span>(locs) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">addTiles</span>() <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">addMarkers</span>(<span class="op">~</span><span class="st"> </span>Longitude, <span class="op">~</span><span class="st"> </span>Latitude, <span class="dt">popup =</span> <span class="op">~</span><span class="st"> </span>Location)</code></pre></div>
<p>You can publish these interactive maps on the web for free by using GitHub. If you are interested, check out [here] (<a href="https://rstudio.github.io/leaflet/" class="uri">https://rstudio.github.io/leaflet/</a>).</p>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="lecture-4-data-cleaning-and-manipulation.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page"><i class="fa fa-angle-left"></i></a>

    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
